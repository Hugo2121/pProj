Thu Oct 23 15:54:22 PDT 2014
 This script captures ICMP destination unreachable messages for a target host.
 The user is prompted to enter the target host, then the eth1 interface of the target host is turned off.
 Target is pinged and the ICMP message is captured using tcpdump.
 The captured message is saved in a file "unreachable.cap" and displayed using tcpdump command.
 It is also possible to open and view the .cap file in wireshark, if so desired.
 A log file of the execuriton of this script is saved in "log.unreachable.txt" and can be viewed at a later date.
 Please enter a target host from the follwoing list: 
april
june
september
summer
fall
equinox
august
november
autumn
may
july
winter
october
solstice
year
->


 You are currently running the script "unreachable.sh" on "spring" with admin IP address: "192.168.0.20"
 "spring" belongs to subnetwork "net17" with IP address: "172.17.1.20"

 The target you chose is "july" with admin IP address: "192.168.0.7"
 "july" belongs to subnetowrk "net18" with IP address: "172.18.1.7"

 Turning off eth1 NIC on "july" ....
 Process complete... 

eth0      Link encap:Ethernet  HWaddr 00:50:56:a4:3a:91  
          inet addr:192.168.0.7  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::250:56ff:fea4:3a91/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:177200 errors:0 dropped:0 overruns:0 frame:0
          TX packets:160498 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:21501529 (20.5 MB)  TX bytes:38520497 (36.7 MB)
          Interrupt:16 Base address:0x2024 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:34667 errors:0 dropped:0 overruns:0 frame:0
          TX packets:34667 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:24458152 (23.3 MB)  TX bytes:24458152 (23.3 MB)


 Starting the sequence to capture ICMP UNREACHABLE message.... 

 Restoring eth1 NIC on "july" .... 
 Process complete... 
eth0      Link encap:Ethernet  HWaddr 00:50:56:a4:3a:91  
          inet addr:192.168.0.7  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::250:56ff:fea4:3a91/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:177773 errors:0 dropped:0 overruns:0 frame:0
          TX packets:161310 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:21607597 (20.6 MB)  TX bytes:38591933 (36.8 MB)
          Interrupt:16 Base address:0x2024 

eth1      Link encap:Ethernet  HWaddr 00:50:56:a4:6b:cd  
          inet addr:172.18.1.7  Bcast:172.18.255.255  Mask:255.255.0.0
          inet6 addr: fe80::250:56ff:fea4:6bcd/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:77917 errors:0 dropped:0 overruns:0 frame:0
          TX packets:15009 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:9239165 (8.8 MB)  TX bytes:2868227 (2.7 MB)
          Interrupt:17 Base address:0x20a4 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:34667 errors:0 dropped:0 overruns:0 frame:0
          TX packets:34667 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:24458152 (23.3 MB)  TX bytes:24458152 (23.3 MB)


 Displaying the captured message(s): 

15:55:42.988800 IP (tos 0xc0, ttl 62, id 4067, offset 0, flags [none], proto ICMP (1), length 576) december.net18 > spring.net17: ICMP host july.net18 unreachable, length 556
	IP (tos 0x0, ttl 13, id 0, offset 0, flags [DF], proto UDP (17), length 1500) spring.net17.57834 > july.net18.44485: UDP, length 1472
	0x0000:  0000 0001 0006 0050 56a4 6a0d 0000 0800  .......PV.j.....
	0x0010:  45c0 0240 0fe3 0000 3e01 0fd7 ac12 010c  E..@....>.......
	0x0020:  ac11 0114 0301 5d17 0000 0000 4500 05dc  ......].....E...
	0x0030:  0000 4000 0d11 0dd3 ac11 0114 ac12 0107  ..@.............
	0x0040:  e1ea adc5 05c8 b281 0f00 0000 6b87 4954  ............k.IT
	0x0050:  8511 0f00 0000 0000 0000 0000 0000 0000  ................
	0x0060:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0070:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0080:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0090:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00a0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00b0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00c0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00d0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00e0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00f0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0100:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0110:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0120:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0130:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0140:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0150:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0160:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0170:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0180:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0190:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01a0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01b0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01c0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01d0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01e0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01f0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0200:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0210:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0220:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0230:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0240:  0000 0000 0000 0000 0000 0000 0000 0000  ................
15:55:42.988818 IP (tos 0xc0, ttl 62, id 4068, offset 0, flags [none], proto ICMP (1), length 576) december.net18 > spring.net17: ICMP host july.net18 unreachable, length 556
	IP (tos 0x0, ttl 14, id 0, offset 0, flags [DF], proto UDP (17), length 1500) spring.net17.57834 > july.net18.44486: UDP, length 1472
	0x0000:  0000 0001 0006 0050 56a4 6a0d 0000 0800  .......PV.j.....
	0x0010:  45c0 0240 0fe4 0000 3e01 0fd6 ac12 010c  E..@....>.......
	0x0020:  ac11 0114 0301 5d17 0000 0000 4500 05dc  ......].....E...
	0x0030:  0000 4000 0e11 0cd3 ac11 0114 ac12 0107  ..@.............
	0x0040:  e1ea adc6 05c8 1180 1000 0000 6c87 4954  ............l.IT
	0x0050:  2412 0f00 0000 0000 0000 0000 0000 0000  $...............
	0x0060:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0070:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0080:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0090:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00a0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00b0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00c0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00d0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00e0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00f0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0100:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0110:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0120:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0130:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0140:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0150:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0160:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0170:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0180:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0190:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01a0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01b0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01c0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01d0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01e0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01f0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0200:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0210:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0220:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0230:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0240:  0000 0000 0000 0000 0000 0000 0000 0000  ................
15:55:42.988822 IP (tos 0xc0, ttl 62, id 4069, offset 0, flags [none], proto ICMP (1), length 576) december.net18 > spring.net17: ICMP host july.net18 unreachable, length 556
	IP (tos 0x0, ttl 14, id 0, offset 0, flags [DF], proto UDP (17), length 1500) spring.net17.57834 > july.net18.44487: UDP, length 1472
	0x0000:  0000 0001 0006 0050 56a4 6a0d 0000 0800  .......PV.j.....
	0x0010:  45c0 0240 0fe5 0000 3e01 0fd5 ac12 010c  E..@....>.......
	0x0020:  ac11 0114 0301 5d17 0000 0000 4500 05dc  ......].....E...
	0x0030:  0000 4000 0e11 0cd3 ac11 0114 ac12 0107  ..@.............
	0x0040:  e1ea adc7 05c8 7c7f 1000 0000 6d87 4954  ......|.....m.IT
	0x0050:  b811 0f00 0000 0000 0000 0000 0000 0000  ................
	0x0060:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0070:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0080:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0090:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00a0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00b0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00c0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00d0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00e0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x00f0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0100:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0110:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0120:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0130:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0140:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0150:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0160:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0170:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0180:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0190:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01a0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01b0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01c0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01d0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01e0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x01f0:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0200:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0210:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0220:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0230:  0000 0000 0000 0000 0000 0000 0000 0000  ................
	0x0240:  0000 0000 0000 0000 0000 0000 0000 0000  ................
